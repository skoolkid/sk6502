<!DOCTYPE html>
<html>
<head>
<title>Skool Daze: Routine at $0BAC</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../theme.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="0B3B.html">$0B3B</a>
</td>
<td class="up">Up: <a href="../maps/all.html#0BAC">Map</a></td>
<td class="next">
Next: <a href="0C31.html">$0C31</a>
</td>
</tr>
</table>
<div class="description">$0BAC: Compute the coordinate ranges within which a character can see or be seen</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routines at <a href="0E59.html">$0E59</a> and <a href="0ECF.html">$0ECF</a>.
</div>
</div>
<table class="output">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>
<tr>
<td class="register">(<a href="0072.html#0073">$73</a>)</td>
<td class="register-desc">Minimum y-coordinate</td>
</tr>
<tr>
<td class="register">(<a href="0072.html#0074">$74</a>)</td>
<td class="register-desc">Maximum y-coordinate</td>
</tr>
<tr>
<td class="register">(<a href="0072.html#0075">$75</a>)</td>
<td class="register-desc">Minimum x-coordinate</td>
</tr>
<tr>
<td class="register">(<a href="0072.html#0076">$76</a>)</td>
<td class="register-desc">Maximum x-coordinate</td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="address-2"><span id="0BAC"></span>$0BAC</td>
<td class="instruction">LDA $FB</td>
<td class="comment-1" rowspan="1">Pick up the character's y-coordinate from <a href="00FB.html">$FB</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BAE"></span>$0BAE</td>
<td class="instruction">SEC</td>
<td class="comment-1" rowspan="2">Subtract 3 to get the minimum y-coordinate.</td>
</tr>
<tr>
<td class="address-1"><span id="0BAF"></span>$0BAF</td>
<td class="instruction">SBC #$03</td>
</tr>
<tr>
<td class="address-1"><span id="0BB1"></span>$0BB1</td>
<td class="instruction">BPL <a href="0BAC.html#0BB5">$0BB5</a></td>
<td class="comment-1" rowspan="1">Branch unless the result is negative.</td>
</tr>
<tr>
<td class="address-1"><span id="0BB3"></span>$0BB3</td>
<td class="instruction">LDA #$00</td>
<td class="comment-1" rowspan="1">The minimum y-coordinate will be 0.</td>
</tr>
<tr>
<td class="address-2"><span id="0BB5"></span>$0BB5</td>
<td class="instruction">STA $73</td>
<td class="comment-1" rowspan="1">Store the minimum y-coordinate at <a href="0072.html#0073">$73</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BB7"></span>$0BB7</td>
<td class="instruction">LDA $FB</td>
<td class="comment-1" rowspan="1">Pick up the character's y-coordinate from <a href="00FB.html">$FB</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BB9"></span>$0BB9</td>
<td class="instruction">CLC</td>
<td class="comment-1" rowspan="3">Add 3 to get the maximum y-coordinate and store the result at <a href="0072.html#0074">$74</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BBA"></span>$0BBA</td>
<td class="instruction">ADC #$03</td>
</tr>
<tr>
<td class="address-1"><span id="0BBC"></span>$0BBC</td>
<td class="instruction">STA $74</td>
</tr>
<tr>
<td class="address-1"><span id="0BBE"></span>$0BBE</td>
<td class="instruction">LDA $FB</td>
<td class="comment-1" rowspan="1">Pick up the character's y-coordinate from <a href="00FB.html">$FB</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BC0"></span>$0BC0</td>
<td class="instruction">CMP #$04</td>
<td class="comment-1" rowspan="1">Is the character on the top floor?</td>
</tr>
<tr>
<td class="address-1"><span id="0BC2"></span>$0BC2</td>
<td class="instruction">BCC <a href="0BAC.html#0C05">$0C05</a></td>
<td class="comment-1" rowspan="1">Branch if so.</td>
</tr>
<tr>
<td class="address-1"><span id="0BC4"></span>$0BC4</td>
<td class="instruction">CMP #$0B</td>
<td class="comment-1" rowspan="1">Is the character between the middle and top floors?</td>
</tr>
<tr>
<td class="address-1"><span id="0BC6"></span>$0BC6</td>
<td class="instruction">BCC <a href="0BAC.html#0BE2">$0BE2</a></td>
<td class="comment-1" rowspan="1">Branch if so.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="0BC8"></span>
<div class="comments">
<div class="paragraph">
The character is between the bottom and middle floors.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="0BC8"></span>$0BC8</td>
<td class="instruction">LDA $FC</td>
<td class="comment-1" rowspan="1">Pick up the character's x-coordinate from <a href="00FB.html#00FC">$FC</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BCA"></span>$0BCA</td>
<td class="instruction">CLC</td>
<td class="comment-1" rowspan="3">Add 10 to get the maximum x-coordinate and store the result at <a href="0072.html#0076">$76</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BCB"></span>$0BCB</td>
<td class="instruction">ADC #$0A</td>
</tr>
<tr>
<td class="address-1"><span id="0BCD"></span>$0BCD</td>
<td class="instruction">STA $76</td>
</tr>
<tr>
<td class="address-1"><span id="0BCF"></span>$0BCF</td>
<td class="instruction">LDA $FC</td>
<td class="comment-1" rowspan="1">Pick up the character's x-coordinate from <a href="00FB.html#00FC">$FC</a>.</td>
</tr>
<tr>
<td class="address-2"><span id="0BD1"></span>$0BD1</td>
<td class="instruction">SEC</td>
<td class="comment-1" rowspan="3">Subtract 10 from <span class="register">A</span> to get the minimum x-coordinate and store the result at <a href="0072.html#0075">$75</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BD2"></span>$0BD2</td>
<td class="instruction">SBC #$0A</td>
</tr>
<tr>
<td class="address-1"><span id="0BD4"></span>$0BD4</td>
<td class="instruction">STA $75</td>
</tr>
<tr>
<td class="address-1"><span id="0BD6"></span>$0BD6</td>
<td class="instruction">BMI <a href="0BAC.html#0BDB">$0BDB</a></td>
<td class="comment-1" rowspan="1">Branch if the result was negative.</td>
</tr>
<tr>
<td class="address-1"><span id="0BD8"></span>$0BD8</td>
<td class="instruction">JMP <a href="0BAC.html#0C30">$0C30</a></td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="address-2"><span id="0BDB"></span>$0BDB</td>
<td class="instruction">LDA #$00</td>
<td class="comment-1" rowspan="2">Store 0 (the minimum x-coordinate) at <a href="0072.html#0075">$75</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BDD"></span>$0BDD</td>
<td class="instruction">STA $75</td>
</tr>
<tr>
<td class="address-1"><span id="0BDF"></span>$0BDF</td>
<td class="instruction">JMP <a href="0BAC.html#0C30">$0C30</a></td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="0BE2"></span>
<div class="comments">
<div class="paragraph">
The character is between the middle and top floors.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="0BE2"></span>$0BE2</td>
<td class="instruction">LDA $FC</td>
<td class="comment-1" rowspan="1">Pick up the character's x-coordinate from <a href="00FB.html#00FC">$FC</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BE4"></span>$0BE4</td>
<td class="instruction">CMP #$26</td>
<td class="comment-1" rowspan="1">Is he to the left of the Exam Room wall?</td>
</tr>
<tr>
<td class="address-1"><span id="0BE6"></span>$0BE6</td>
<td class="instruction">BCC <a href="0BAC.html#0BFA">$0BFA</a></td>
<td class="comment-1" rowspan="1">Branch if so.</td>
</tr>
<tr>
<td class="address-1"><span id="0BE8"></span>$0BE8</td>
<td class="instruction">CLC</td>
<td class="comment-1" rowspan="3">Add 10 to the character's x-coordinate and store it at <a href="0072.html#0076">$76</a>. This is the maximum x-coordinate.</td>
</tr>
<tr>
<td class="address-1"><span id="0BE9"></span>$0BE9</td>
<td class="instruction">ADC #$0A</td>
</tr>
<tr>
<td class="address-1"><span id="0BEB"></span>$0BEB</td>
<td class="instruction">STA $76</td>
</tr>
<tr>
<td class="address-1"><span id="0BED"></span>$0BED</td>
<td class="instruction">LDA $FC</td>
<td class="comment-1" rowspan="1">Pick up the character's x-coordinate from <a href="00FB.html#00FC">$FC</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0BEF"></span>$0BEF</td>
<td class="instruction">CMP #$30</td>
<td class="comment-1" rowspan="1">Is the character's x-coordinate greater than 47?</td>
</tr>
<tr>
<td class="address-1"><span id="0BF1"></span>$0BF1</td>
<td class="instruction">BCS <a href="0BAC.html#0BD1">$0BD1</a></td>
<td class="comment-1" rowspan="1">Branch if so.</td>
</tr>
<tr>
<td class="address-1"><span id="0BF3"></span>$0BF3</td>
<td class="instruction">LDA #$26</td>
<td class="comment-1" rowspan="2">Store the x-coordinate of the Exam Room wall (38) at <a href="0072.html#0075">$75</a>: teachers can't see through it into the White Room.</td>
</tr>
<tr>
<td class="address-1"><span id="0BF5"></span>$0BF5</td>
<td class="instruction">STA $75</td>
</tr>
<tr>
<td class="address-1"><span id="0BF7"></span>$0BF7</td>
<td class="instruction">JMP <a href="0BAC.html#0C30">$0C30</a></td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="address-2"><span id="0BFA"></span>$0BFA</td>
<td class="instruction">CMP #$1C</td>
<td class="comment-1" rowspan="1">Is the character's x-coordinate less than 28?</td>
</tr>
<tr>
<td class="address-1"><span id="0BFC"></span>$0BFC</td>
<td class="instruction">BCC <a href="0BAC.html#0C28">$0C28</a></td>
<td class="comment-1" rowspan="1">Branch if so.</td>
</tr>
<tr>
<td class="address-1"><span id="0BFE"></span>$0BFE</td>
<td class="instruction">LDA #$25</td>
<td class="comment-1" rowspan="2">Store the x-coordinate of the White Room wall (37) at <a href="0072.html#0076">$76</a>: teachers can't see through it into the Exam Room.</td>
</tr>
<tr>
<td class="address-1"><span id="0C00"></span>$0C00</td>
<td class="instruction">STA $76</td>
</tr>
<tr>
<td class="address-1"><span id="0C02"></span>$0C02</td>
<td class="instruction">JMP <a href="0BAC.html#0BD1">$0BD1</a></td>
<td class="comment-1" rowspan="1">Jump back. (This is a <a href="../reference/bugs.html#invisibilityRange">bug</a>. The jump should be to <a href="0BAC.html#0BCF">$0BCF</a> instead.)</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="0C05"></span>
<div class="comments">
<div class="paragraph">
The character is on the top floor.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="0C05"></span>$0C05</td>
<td class="instruction">LDA $FC</td>
<td class="comment-1" rowspan="1">Pick up the character's x-coordinate from <a href="00FB.html#00FC">$FC</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0C07"></span>$0C07</td>
<td class="instruction">CMP #$39</td>
<td class="comment-1" rowspan="1">Is the character to the left of the Map Room wall?</td>
</tr>
<tr>
<td class="address-1"><span id="0C09"></span>$0C09</td>
<td class="instruction">BCC <a href="0BAC.html#0C1D">$0C1D</a></td>
<td class="comment-1" rowspan="1">Branch if so.</td>
</tr>
<tr>
<td class="address-1"><span id="0C0B"></span>$0C0B</td>
<td class="instruction">CLC</td>
<td class="comment-1" rowspan="3">Add 10 to the character's x-coordinate and store it at <a href="0072.html#0076">$76</a>. This is the maximum x-coordinate.</td>
</tr>
<tr>
<td class="address-1"><span id="0C0C"></span>$0C0C</td>
<td class="instruction">ADC #$0A</td>
</tr>
<tr>
<td class="address-1"><span id="0C0E"></span>$0C0E</td>
<td class="instruction">STA $76</td>
</tr>
<tr>
<td class="address-1"><span id="0C10"></span>$0C10</td>
<td class="instruction">LDA $FC</td>
<td class="comment-1" rowspan="1">Pick up the character's x-coordinate from <a href="00FB.html#00FC">$FC</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="0C12"></span>$0C12</td>
<td class="instruction">CMP #$43</td>
<td class="comment-1" rowspan="1">Is the character's x-coordinate 67 or more?</td>
</tr>
<tr>
<td class="address-1"><span id="0C14"></span>$0C14</td>
<td class="instruction">BCS <a href="0BAC.html#0BD1">$0BD1</a></td>
<td class="comment-1" rowspan="1">Branch if so.</td>
</tr>
<tr>
<td class="address-1"><span id="0C16"></span>$0C16</td>
<td class="instruction">LDA #$39</td>
<td class="comment-1" rowspan="2">Store the x-coordinate of the Map Room wall (57) at <a href="0072.html#0075">$75</a>: teachers can't see through it into the Reading Room.</td>
</tr>
<tr>
<td class="address-1"><span id="0C18"></span>$0C18</td>
<td class="instruction">STA $75</td>
</tr>
<tr>
<td class="address-1"><span id="0C1A"></span>$0C1A</td>
<td class="instruction">JMP <a href="0BAC.html#0C30">$0C30</a></td>
<td class="comment-1" rowspan="1">Return.</td>
</tr>
<tr>
<td class="address-2"><span id="0C1D"></span>$0C1D</td>
<td class="instruction">CMP #$2F</td>
<td class="comment-1" rowspan="1">Is the character's x-coordinate less than 47?</td>
</tr>
<tr>
<td class="address-1"><span id="0C1F"></span>$0C1F</td>
<td class="instruction">BCC <a href="0BAC.html#0C28">$0C28</a></td>
<td class="comment-1" rowspan="1">Branch if so.</td>
</tr>
<tr>
<td class="address-1"><span id="0C21"></span>$0C21</td>
<td class="instruction">LDA #$38</td>
<td class="comment-1" rowspan="2">Store the x-coordinate of the Reading Room wall (56) at <a href="0072.html#0076">$76</a>: teachers can't see through it into the Map Room.</td>
</tr>
<tr>
<td class="address-1"><span id="0C23"></span>$0C23</td>
<td class="instruction">STA $76</td>
</tr>
<tr>
<td class="address-1"><span id="0C25"></span>$0C25</td>
<td class="instruction">JMP <a href="0BAC.html#0BD1">$0BD1</a></td>
<td class="comment-1" rowspan="1">Jump back. (This is a <a href="../reference/bugs.html#invisibilityRange">bug</a>. The jump should be to <a href="0BAC.html#0BCF">$0BCF</a> instead.)</td>
</tr>
<tr>
<td class="address-2"><span id="0C28"></span>$0C28</td>
<td class="instruction">CLC</td>
<td class="comment-1" rowspan="3">Add 10 to the character's x-coordinate and store it at <a href="0072.html#0076">$76</a>. This is the maximum x-coordinate.</td>
</tr>
<tr>
<td class="address-1"><span id="0C29"></span>$0C29</td>
<td class="instruction">ADC #$0A</td>
</tr>
<tr>
<td class="address-1"><span id="0C2B"></span>$0C2B</td>
<td class="instruction">STA $76</td>
</tr>
<tr>
<td class="address-1"><span id="0C2D"></span>$0C2D</td>
<td class="instruction">JMP <a href="0BAC.html#0BD1">$0BD1</a></td>
<td class="comment-1" rowspan="1">Jump back. (This is a <a href="../reference/bugs.html#invisibilityRange">bug</a>. The jump should be to <a href="0BAC.html#0BCF">$0BCF</a> instead.)</td>
</tr>
<tr>
<td class="address-2"><span id="0C30"></span>$0C30</td>
<td class="instruction">RTS</td>
<td class="comment-1" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="0B3B.html">$0B3B</a>
</td>
<td class="up">Up: <a href="../maps/all.html#0BAC">Map</a></td>
<td class="next">
Next: <a href="0C31.html">$0C31</a>
</td>
</tr>
</table>
<footer>
<div class="release">The complete Skool Daze C64 disassembly 20210325</div>
<div class="copyright">&#169; 1985 Microsphere Computer Services Ltd. &#169; 2021 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.4 and <a href="https://github.com/skoolkid/sk6502">sk6502</a>.</div>
</footer>
</body>
</html>