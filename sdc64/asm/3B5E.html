<!DOCTYPE html>
<html>
<head>
<title>Skool Daze: Routine at $3B5E</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../theme.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="3B46.html">$3B46</a>
</td>
<td class="up">Up: <a href="../maps/all.html#3B5E">Map</a></td>
<td class="next">
Next: <a href="3BE7.html">$3BE7</a>
</td>
</tr>
</table>
<div class="description">$3B5E: Move the current character</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="3AB4.html">$3AB4</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="3B5E"></span>$3B5E</td>
<td class="instruction">LDA $60</td>
<td class="comment-1" rowspan="1">Pick up the current character number from <a href="0060.html">$60</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="3B60"></span>$3B60</td>
<td class="instruction">CMP #$12</td>
<td class="comment-1" rowspan="1">Is it $12 (BOY WONDER's pellet)?</td>
</tr>
<tr>
<td class="address-1"><span id="3B62"></span>$3B62</td>
<td class="instruction">BEQ <a href="3B5E.html#3BA0">$3BA0</a></td>
<td class="comment-1" rowspan="1">Branch if so.</td>
</tr>
<tr>
<td class="address-1"><span id="3B64"></span>$3B64</td>
<td class="instruction">CMP #$13</td>
<td class="comment-1" rowspan="1">Is the current character number $13 (ERIC's pellet)?</td>
</tr>
<tr>
<td class="address-1"><span id="3B66"></span>$3B66</td>
<td class="instruction">BEQ <a href="3B5E.html#3BA0">$3BA0</a></td>
<td class="comment-1" rowspan="1">Branch if so.</td>
</tr>
<tr>
<td class="address-1"><span id="3B68"></span>$3B68</td>
<td class="instruction">DEC $FF</td>
<td class="comment-1" rowspan="1">Decrement the character's movement speed change delay counter at <a href="00FF.html">$FF</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="3B6A"></span>$3B6A</td>
<td class="instruction">BEQ <a href="3B5E.html#3B7A">$3B7A</a></td>
<td class="comment-1" rowspan="1">Branch if it's time to consider a change in movement speed.</td>
</tr>
<tr>
<td class="address-1"><span id="3B6C"></span>$3B6C</td>
<td class="instruction">LDA $FF</td>
<td class="comment-1" rowspan="1">Pick up the character's movement speed change delay counter from <a href="00FF.html">$FF</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="3B6E"></span>$3B6E</td>
<td class="instruction">LSR A</td>
<td class="comment-1" rowspan="1">Is the new value even?</td>
</tr>
<tr>
<td class="address-1"><span id="3B6F"></span>$3B6F</td>
<td class="instruction">BCC <a href="3B5E.html#3BA0">$3BA0</a></td>
<td class="comment-1" rowspan="1">Branch if so (half the time) to move the character.</td>
</tr>
<tr>
<td class="address-1"><span id="3B71"></span>$3B71</td>
<td class="instruction">LDA $3F</td>
<td class="comment-1" rowspan="1">Pick up the flags byte from <a href="003F.html">$3F</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="3B73"></span>$3B73</td>
<td class="instruction">AND #$40</td>
<td class="comment-1" rowspan="1">Is bit 6 set, meaning the character is running (or otherwise moving quickly)?</td>
</tr>
<tr>
<td class="address-1"><span id="3B75"></span>$3B75</td>
<td class="instruction">BNE <a href="3B5E.html#3BA0">$3BA0</a></td>
<td class="comment-1" rowspan="1">Branch if so to move the character now.</td>
</tr>
<tr>
<td class="address-1"><span id="3B77"></span>$3B77</td>
<td class="instruction">JMP <a href="3B5E.html#3BE6">$3BE6</a></td>
<td class="comment-1" rowspan="1">Otherwise return without having moved the character.</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="3B7A"></span>
<div class="comments">
<div class="paragraph">
It's time to consider a movement speed change for this character.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="3B7A"></span>$3B7A</td>
<td class="instruction">LDA $D41B</td>
<td class="comment-1" rowspan="3">Generate a random value between 4 and 67.</td>
</tr>
<tr>
<td class="address-1"><span id="3B7D"></span>$3B7D</td>
<td class="instruction">AND #$3F</td>
</tr>
<tr>
<td class="address-1"><span id="3B7F"></span>$3B7F</td>
<td class="instruction">ADC #$04</td>
</tr>
<tr>
<td class="address-1"><span id="3B81"></span>$3B81</td>
<td class="instruction">LSR A</td>
<td class="comment-1" rowspan="1">Now 2&lt;=<span class="register">A</span>&lt;=33, and the carry flag is set if the random value is odd.</td>
</tr>
<tr>
<td class="address-1"><span id="3B82"></span>$3B82</td>
<td class="instruction">STA $FF</td>
<td class="comment-1" rowspan="1">Reinitialise the movement speed change delay counter at <a href="00FF.html">$FF</a> with this value.</td>
</tr>
<tr>
<td class="address-1"><span id="3B84"></span>$3B84</td>
<td class="instruction">BCC <a href="3B5E.html#3B90">$3B90</a></td>
<td class="comment-1" rowspan="1">Branch if the random value is even.</td>
</tr>
<tr>
<td class="address-1"><span id="3B86"></span>$3B86</td>
<td class="instruction">LDA $3F</td>
<td class="comment-1" rowspan="3">Set bit 6 of the flags byte at <a href="003F.html">$3F</a>: the character is running (or otherwise moving quickly).</td>
</tr>
<tr>
<td class="address-1"><span id="3B88"></span>$3B88</td>
<td class="instruction">ORA #$40</td>
</tr>
<tr>
<td class="address-1"><span id="3B8A"></span>$3B8A</td>
<td class="instruction">STA $3F</td>
</tr>
<tr>
<td class="address-1"><span id="3B8C"></span>$3B8C</td>
<td class="instruction">AND #$05</td>
<td class="comment-1" rowspan="1">Is bit 2 of the flags byte set, meaning this character is either a teacher, or EINSTEIN speaking?</td>
</tr>
<tr>
<td class="address-1"><span id="3B8E"></span>$3B8E</td>
<td class="instruction">BEQ <a href="3B5E.html#3BA0">$3BA0</a></td>
<td class="comment-1" rowspan="1">Branch if not to move the character now.</td>
</tr>
<tr>
<td class="address-2"><span id="3B90"></span>$3B90</td>
<td class="instruction">LDA $3F</td>
<td class="comment-1" rowspan="3">Reset bit 6 of the flags byte at <a href="003F.html">$3F</a>: the character is walking (or otherwise moving) at a normal pace.</td>
</tr>
<tr>
<td class="address-1"><span id="3B92"></span>$3B92</td>
<td class="instruction">AND #$BF</td>
</tr>
<tr>
<td class="address-1"><span id="3B94"></span>$3B94</td>
<td class="instruction">STA $3F</td>
</tr>
<tr>
<td class="address-1"><span id="3B96"></span>$3B96</td>
<td class="instruction">AND #$0A</td>
<td class="comment-1" rowspan="1">Is bit 1 or bit 3 of the flags byte set (meaning the character is a stampeding boy, MR WACKER looking for the pea-shooter, or EINSTEIN waiting to answer a teacher's question)?</td>
</tr>
<tr>
<td class="address-1"><span id="3B98"></span>$3B98</td>
<td class="instruction">BEQ <a href="3B5E.html#3BA0">$3BA0</a></td>
<td class="comment-1" rowspan="1">Branch if not to move the character now.</td>
</tr>
<tr>
<td class="address-1"><span id="3B9A"></span>$3B9A</td>
<td class="instruction">LDA $3F</td>
<td class="comment-1" rowspan="3">Set bit 6 of the flags byte at <a href="003F.html">$3F</a>: the character is running (or otherwise moving quickly).</td>
</tr>
<tr>
<td class="address-1"><span id="3B9C"></span>$3B9C</td>
<td class="instruction">ORA #$40</td>
</tr>
<tr>
<td class="address-1"><span id="3B9E"></span>$3B9E</td>
<td class="instruction">STA $3F</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="3BA0"></span>
<div class="comments">
<div class="paragraph">
Now we consider the character's next move. From this point, the following steps are taken:
</div>
<div class="paragraph">
<ul class="">
<li>If there is an uninterruptible subcommand routine address at <a href="00B0.html">$B0</a>, jump to it.</li>
<li>Otherwise, if there is a continual subcommand routine address at <a href="0039.html">$39</a>, jump to it (and then return to execute the next step below).</li>
<li>If there is an interruptible subcommand routine address at <a href="00AA.html">$AA</a>, jump to it.</li>
<li>Otherwise, restart the command list if bit 7 of the flags byte at <a href="003F.html">$3F</a> is set.</li>
<li>If there is a primary command routine address at <a href="0029.html">$29</a>, jump to it.</li>
<li>Otherwise, collect the next primary command routine address from the command list, place it at <a href="0029.html">$29</a>, and jump to it.</li>
</ul>
</div>
<div class="paragraph">
The address of one of the following uninterruptible subcommand routines may be present at <a href="00B0.html">$B0</a>:
</div>
<div class="paragraph">
<table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Description</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="0FBA.html">$0FBA</a></td>
<td class="" colspan="1" rowspan="1">Control the horizontal flight of a catapult pellet</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="1042.html">$1042</a></td>
<td class="" colspan="1" rowspan="1">Control the vertical flight of a catapult pellet</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="1CB4.html">$1CB4</a></td>
<td class="" colspan="1" rowspan="1">Deal with a character who's been dethroned (1)</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="1CCB.html">$1CCB</a></td>
<td class="" colspan="1" rowspan="1">Deal with a character who's been dethroned (2)</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="1CEC.html">$1CEC</a></td>
<td class="" colspan="1" rowspan="1">Deal with a character who is looking for a seat</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="267A.html">$267A</a></td>
<td class="" colspan="1" rowspan="1">Make ANGELFACE throw a punch (1)</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2696.html">$2696</a></td>
<td class="" colspan="1" rowspan="1">Make ANGELFACE throw a punch (2)</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="26E0.html">$26E0</a></td>
<td class="" colspan="1" rowspan="1">Make ANGELFACE finish punching or BOY WONDER finish firing his catapult</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2A43.html">$2A43</a></td>
<td class="" colspan="1" rowspan="1">Deal with a character who has been knocked over</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2B21.html">$2B21</a></td>
<td class="" colspan="1" rowspan="1">Make BOY WONDER fire his catapult (1)</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2B3F.html">$2B3F</a></td>
<td class="" colspan="1" rowspan="1">Make BOY WONDER fire his catapult (2)</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2B52.html">$2B52</a></td>
<td class="" colspan="1" rowspan="1">Make BOY WONDER fire his catapult (3)</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2B9F.html">$2B9F</a></td>
<td class="" colspan="1" rowspan="1">Make BOY WONDER fire his catapult (4)</td>
</tr>
</table>
</div>
<div class="paragraph">
The address of one of the following continual subcommand routines may be present at <a href="0039.html">$39</a>:
</div>
<div class="paragraph">
<table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Description</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="26EF.html">$26EF</a></td>
<td class="" colspan="1" rowspan="1">Check whether ANGELFACE is touching ERIC</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="270D.html">$270D</a></td>
<td class="" colspan="1" rowspan="1">Make ANGELFACE hit now and then</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2797.html">$2797</a></td>
<td class="" colspan="1" rowspan="1">Make the stampede leader trip people up on the way to a random location</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2873.html">$2873</a></td>
<td class="" colspan="1" rowspan="1">Make a little boy trip people up</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2CA5.html">$2CA5</a></td>
<td class="" colspan="1" rowspan="1">Make BOY WONDER fire his catapult now and then</td>
</tr>
</table>
</div>
<div class="paragraph">
The address of one of the following interruptible subcommand routines (or an entry point thereof) may be present at <a href="00AA.html">$AA</a>:
</div>
<div class="paragraph">
<table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Description</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="0C3F.html">$0C3F</a></td>
<td class="" colspan="1" rowspan="1">Make a character track down ERIC</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="1129.html">$1129</a></td>
<td class="" colspan="1" rowspan="1">Make a character write on a blackboard</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="136F.html">$136F</a></td>
<td class="" colspan="1" rowspan="1">Guide a character to an intermediate destination</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="13F3.html">$13F3</a></td>
<td class="" colspan="1" rowspan="1">Guide a character up or down a staircase</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="16E9.html">$16E9</a></td>
<td class="" colspan="1" rowspan="1">Make a teacher wipe a blackboard</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="1EE3.html#1F1E">$1F1E</a></td>
<td class="" colspan="1" rowspan="1">Make a teacher wait for EINSTEIN to finish speaking</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2387.html">$2387</a></td>
<td class="" colspan="1" rowspan="1">Make a character speak</td>
</tr>
</table>
</div>
<div class="paragraph">
The address of one of the following primary command routines (or an entry point thereof) may be present at <a href="0029.html">$29</a>:
</div>
<div class="paragraph">
<table class="default">
<tr>
<th colspan="1" rowspan="1">Address</th>
<th colspan="1" rowspan="1">Description</th>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="09E9.html">$09E9</a></td>
<td class="" colspan="1" rowspan="1">Make a teacher conduct a class</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="0A57.html">$0A57</a></td>
<td class="" colspan="1" rowspan="1">Do nothing</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="0A58.html">$0A58</a></td>
<td class="" colspan="1" rowspan="1">Make a teacher conduct a class with ERIC</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="0E35.html">$0E35</a></td>
<td class="" colspan="1" rowspan="1">Make a teacher perform dinner duty</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="0EB4.html">$0EB4</a></td>
<td class="" colspan="1" rowspan="1">Restart the command list</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="0EC2.html">$0EC2</a></td>
<td class="" colspan="1" rowspan="1">Restart the command list unless it's time to start the lesson</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="105B.html">$105B</a></td>
<td class="" colspan="1" rowspan="1">Make a character go to a random location</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="1A04.html">$1A04</a></td>
<td class="" colspan="1" rowspan="1">Make a character walk up and down until a certain time</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="1D16.html">$1D16</a></td>
<td class="" colspan="1" rowspan="1">Make a character find a seat</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="1F4D.html">$1F4D</a></td>
<td class="" colspan="1" rowspan="1">Control EINSTEIN during class</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="1FA0.html">$1FA0</a></td>
<td class="" colspan="1" rowspan="1">Make a teacher tell the kids to sit down</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2757.html">$2757</a></td>
<td class="" colspan="1" rowspan="1">Make a teacher tell ERIC to go home, and end the game</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="277D.html">$277D</a></td>
<td class="" colspan="1" rowspan="1">Make MR WACKER give ERIC 2000 lines</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="27AB.html">$27AB</a></td>
<td class="" colspan="1" rowspan="1">Make a character walk up and down a few times or until a certain time</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="284F.html">$284F</a></td>
<td class="" colspan="1" rowspan="1">Make MR WACKER run to a given location</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2865.html">$2865</a></td>
<td class="" colspan="1" rowspan="1">Place a continual subcommand routine address into a character's buffer</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2885.html">$2885</a></td>
<td class="" colspan="1" rowspan="1">Make a little boy find and follow little boy no. 1</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="28AB.html">$28AB</a></td>
<td class="" colspan="1" rowspan="1">Make BOY WONDER write on a blackboard</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="28BC.html">$28BC</a></td>
<td class="" colspan="1" rowspan="1">Make little boy no. 10 give ERIC a message</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2A99.html">$2A99</a></td>
<td class="" colspan="1" rowspan="1">Make a character find ERIC</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2AF9.html">$2AF9</a></td>
<td class="" colspan="1" rowspan="1">Raise the signal for a certain event and move to the next command</td>
</tr>
<tr>
<td class="centre" colspan="1" rowspan="1"><a href="2B0D.html">$2B0D</a></td>
<td class="" colspan="1" rowspan="1">Lower the signal for a certain event and move to the next command</td>
</tr>
</table>
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="3BA0"></span>$3BA0</td>
<td class="instruction">LDA $B1</td>
<td class="comment-1" rowspan="1">Is there an uninterruptible subcommand routine address at <a href="00B0.html">$B0</a>?</td>
</tr>
<tr>
<td class="address-1"><span id="3BA2"></span>$3BA2</td>
<td class="instruction">BEQ <a href="3B5E.html#3BA7">$3BA7</a></td>
<td class="comment-1" rowspan="1">Branch if not.</td>
</tr>
<tr>
<td class="address-1"><span id="3BA4"></span>$3BA4</td>
<td class="instruction">JMP (<a href="00B0.html">$00B0</a>)</td>
<td class="comment-1" rowspan="1">Otherwise jump to the uninterruptible subcommand routine.</td>
</tr>
<tr>
<td class="address-2"><span id="3BA7"></span>$3BA7</td>
<td class="instruction">LDA $3A</td>
<td class="comment-1" rowspan="1">Is there a continual subcommand routine address at <a href="0039.html">$39</a>?</td>
</tr>
<tr>
<td class="address-1"><span id="3BA9"></span>$3BA9</td>
<td class="instruction">BEQ <a href="3B5E.html#3BB4">$3BB4</a></td>
<td class="comment-1" rowspan="1">Branch if not.</td>
</tr>
<tr>
<td class="address-1"><span id="3BAB"></span>$3BAB</td>
<td class="instruction">LDA #$3B</td>
<td class="comment-1" rowspan="4">Push $3BB3 onto the stack so that we return to <a href="3B5E.html#3BB4">$3BB4</a> below after executing the continual subcommand routine.</td>
</tr>
<tr>
<td class="address-1"><span id="3BAD"></span>$3BAD</td>
<td class="instruction">PHA</td>
</tr>
<tr>
<td class="address-1"><span id="3BAE"></span>$3BAE</td>
<td class="instruction">LDA #$B3</td>
</tr>
<tr>
<td class="address-1"><span id="3BB0"></span>$3BB0</td>
<td class="instruction">PHA</td>
</tr>
<tr>
<td class="address-1"><span id="3BB1"></span>$3BB1</td>
<td class="instruction">JMP (<a href="0039.html">$0039</a>)</td>
<td class="comment-1" rowspan="1">Jump to the continual subcommand routine.</td>
</tr>
<tr>
<td class="address-2"><span id="3BB4"></span>$3BB4</td>
<td class="instruction">LDA $AB</td>
<td class="comment-1" rowspan="1">Is there an interruptible subcommand routine address at <a href="00AA.html">$AA</a>?</td>
</tr>
<tr>
<td class="address-1"><span id="3BB6"></span>$3BB6</td>
<td class="instruction">BEQ <a href="3B5E.html#3BBB">$3BBB</a></td>
<td class="comment-1" rowspan="1">Branch if not.</td>
</tr>
<tr>
<td class="address-1"><span id="3BB8"></span>$3BB8</td>
<td class="instruction">JMP (<a href="00AA.html">$00AA</a>)</td>
<td class="comment-1" rowspan="1">Otherwise jump to the interruptible subcommand routine.</td>
</tr>
<tr>
<td class="address-2"><span id="3BBB"></span>$3BBB</td>
<td class="instruction">LDA $3F</td>
<td class="comment-1" rowspan="1">Pick up the flags byte from <a href="003F.html">$3F</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="3BBD"></span>$3BBD</td>
<td class="instruction">ASL A</td>
<td class="comment-1" rowspan="1">Is a command list restart required (bit 7 set)?</td>
</tr>
<tr>
<td class="address-1"><span id="3BBE"></span>$3BBE</td>
<td class="instruction">BCC <a href="3B5E.html#3BDF">$3BDF</a></td>
<td class="comment-1" rowspan="1">Branch if not.</td>
</tr>
<tr>
<td class="address-1"><span id="3BC0"></span>$3BC0</td>
<td class="instruction">LDA $3F</td>
<td class="comment-1" rowspan="3">Reset bit 7 of the flags byte at <a href="003F.html">$3F</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="3BC2"></span>$3BC2</td>
<td class="instruction">AND #$7F</td>
</tr>
<tr>
<td class="address-1"><span id="3BC4"></span>$3BC4</td>
<td class="instruction">STA $3F</td>
</tr>
<tr>
<td class="address-1"><span id="3BC6"></span>$3BC6</td>
<td class="instruction">LDA $3D</td>
<td class="comment-1" rowspan="4">Copy the command list start address from <a href="003D.html">$3D</a> to <a href="003B.html">$3B</a>. This has the effect of restarting the command list.</td>
</tr>
<tr>
<td class="address-1"><span id="3BC8"></span>$3BC8</td>
<td class="instruction">STA $3B</td>
</tr>
<tr>
<td class="address-1"><span id="3BCA"></span>$3BCA</td>
<td class="instruction">LDA $3E</td>
</tr>
<tr>
<td class="address-1"><span id="3BCC"></span>$3BCC</td>
<td class="instruction">STA $3C</td>
</tr>
<tr>
<td class="address-2"><span id="3BCE"></span>$3BCE</td>
<td class="instruction">LDY #$00</td>
<td class="comment-1" rowspan="2">Remove the address of any continual subcommand routine from <a href="0039.html">$39</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="3BD0"></span>$3BD0</td>
<td class="instruction">STY $3A</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="3BD2"></span>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a href="2865.html">$2865</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="3BD2"></span>$3BD2</td>
<td class="instruction">JSR <a href="3BE7.html">$3BE7</a></td>
<td class="comment-1" rowspan="4">Collect the address of the primary command routine from the command list and place it into the character's buffer at <a href="0029.html">$29</a>.</td>
</tr>
<tr>
<td class="address-1"><span id="3BD5"></span>$3BD5</td>
<td class="instruction">STA $29</td>
</tr>
<tr>
<td class="address-1"><span id="3BD7"></span>$3BD7</td>
<td class="instruction">JSR <a href="3BE7.html">$3BE7</a></td>
</tr>
<tr>
<td class="address-1"><span id="3BDA"></span>$3BDA</td>
<td class="instruction">STA $2A</td>
</tr>
<tr>
<td class="address-1"><span id="3BDC"></span>$3BDC</td>
<td class="instruction">JMP <a href="3B5E.html#3BE3">$3BE3</a></td>
<td class="comment-1" rowspan="1">Jump forward.</td>
</tr>
<tr>
<td class="address-2"><span id="3BDF"></span>$3BDF</td>
<td class="instruction">LDA $2A</td>
<td class="comment-1" rowspan="1">Is there a primary command routine address at <a href="0029.html">$29</a>?</td>
</tr>
<tr>
<td class="address-1"><span id="3BE1"></span>$3BE1</td>
<td class="instruction">BEQ <a href="3B5E.html#3BCE">$3BCE</a></td>
<td class="comment-1" rowspan="1">Branch back if not to collect one from the command list.</td>
</tr>
<tr>
<td class="address-2"><span id="3BE3"></span>$3BE3</td>
<td class="instruction">JMP (<a href="0029.html">$0029</a>)</td>
<td class="comment-1" rowspan="1">Jump to the primary command routine.</td>
</tr>
<tr>
<td class="address-2"><span id="3BE6"></span>$3BE6</td>
<td class="instruction">RTS</td>
<td class="comment-1" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="3B46.html">$3B46</a>
</td>
<td class="up">Up: <a href="../maps/all.html#3B5E">Map</a></td>
<td class="next">
Next: <a href="3BE7.html">$3BE7</a>
</td>
</tr>
</table>
<footer>
<div class="release">The complete Skool Daze C64 disassembly 20210325</div>
<div class="copyright">&#169; 1985 Microsphere Computer Services Ltd. &#169; 2021 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.4 and <a href="https://github.com/skoolkid/sk6502">sk6502</a>.</div>
</footer>
</body>
</html>